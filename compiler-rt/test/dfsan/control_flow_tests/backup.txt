PATH  := $(PATH):$(PWD)/bin:../build/bin
SHELL := env PATH=$(PATH) /bin/bash
CC=clang++
CFLAGS=-fsanitize=dataflow
%.out: %.cpp
	$(CC) $(CFLAGS) -o $@ $<

all: test_if_0 test_if_1 test_if_2 test_if_3 test_foo_0 test_foo_1 test_foo_2 test_foo_3 test_foo_4 test_for_0 test_for_1 test_for_2 test_for_3

test_if_0: test_if_0.cpp
	clang++ -fsanitize=dataflow test_if_0.cpp -o test_if_0
test_if_1: test_if_1.cpp
	clang++ -fsanitize=dataflow test_if_1.cpp -o test_if_1
test_if_2: test_if_2.cpp
	clang++ -fsanitize=dataflow test_if_2.cpp -o test_if_2
test_if_3: test_if_3.cpp
	clang++ -fsanitize=dataflow test_if_3.cpp -o test_if_3
test_foo_0: test_foo_0.cpp
	clang++ -fsanitize=dataflow test_foo_0.cpp -o test_foo_0
test_foo_1: test_foo_1.cpp
	clang++ -fsanitize=dataflow test_foo_1.cpp -o test_foo_1
test_foo_2: test_foo_2.cpp
	clang++ -fsanitize=dataflow test_foo_2.cpp -o test_foo_2
test_foo_3: test_foo_3.cpp
	clang++ -fsanitize=dataflow test_foo_3.cpp -o test_foo_3
test_foo_4: test_foo_4.cpp
	clang++ -fsanitize=dataflow test_foo_4.cpp -o test_foo_4
test_for_0: test_for_0.cpp
	clang++ -fsanitize=dataflow test_for_0.cpp -o test_for_0
test_for_1: test_for_1.cpp
	clang++ -fsanitize=dataflow test_for_1.cpp -o test_for_1
test_for_2: test_for_2.cpp
	clang++ -fsanitize=dataflow test_for_2.cpp -o test_for_2

run:
	rm test_if_0 test_if_1 test_if_2 test_if_3 test_foo_0 test_foo_1 test_foo_2 test_foo_3 test_foo_4 test_for_0 test_for_1 test_for_2
	make
	./test_if_0
	./test_if_1
	./test_if_2
	./test_if_3
	./test_foo_0
	./test_foo_1
	./test_foo_2
	./test_foo_3
	./test_foo_4
	./test_for_0
	./test_for_1
	./test_for_2
